{% extends "base.html" %}
{% load static %}

{% block title %}Waste Exchange{% endblock %}

{% block content %}

<div class="container mt-3">

    <div class="d-flex justify-content-between align-items-center mb-3">
        <h2 class="text-success fw-bold mb-0">
            <img src="{% static 'images/recycle.png' %}" height="35">
            Waste Exchange
        </h2>
        <a href="{% url 'register_business' %}" class="btn btn-success">
            + Register Business
        </a>
    </div>


    <div class="mb-3">
        <label class="form-label fw-bold">Filter by Category</label>
        <select id="categoryFilter" class="form-select">
            <option value="all">All Categories</option>
            {% for cat in categories %}
                <option value="{{ cat.name }}">{{ cat.name }}</option>
            {% endfor %}
        </select>
    </div>



    <div id="map" style="width:100%; height:80vh; border-radius:12px; overflow:hidden;"></div>

</div>


<div class="modal fade" id="businessModal" tabindex="-1">
    <div class="modal-dialog modal-dialog-scrollable modal-lg">
        <div class="modal-content">

            <div class="modal-header bg-success text-white">
                <h5 class="modal-title" id="businessName"></h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
            </div>

            <div class="modal-body">

                <center>
                    <img id="businessImage"
                         src=""
                         style="width:250px; border:4px solid #0b7832; border-radius:12px;">
                </center>

                <hr>

                <h6 class="fw-bold">Waste By-products:</h6>
                <p id="businessWaste"></p>

                <hr>

                <h6 class="fw-bold">Contact</h6>
                <p><strong>Phone:</strong> <span id="businessPhone"></span></p>
                <p><strong>Email:</strong> <span id="businessEmail"></span></p>
            </div>

            <div class="modal-footer">
                <button class="btn btn-success">Request Quotation</button>
            </div>

        </div>
    </div>
</div>

<!-- modal + scripts stay exactly as you already have them -->
<script src="{% static 'js/marker_icon.js' %}"></script>
<script src="{% static 'js/waste_exchange.js' %}"></script>
<script>
    const businesses = JSON.parse('{{ businesses_json|escapejs }}');
</script>
<script src="https://maps.googleapis.com/maps/api/js?key={{ GOOGLE_MAPS_KEY }}&callback=initMap" async defer></script>

{% endblock %}
